% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calculateMatchedSurvivalData.R
\name{calculateMatchedSurvivalData}
\alias{calculateMatchedSurvivalData}
\title{Calculate Matched Survival Data using Incidence Density Matching}
\usage{
calculateMatchedSurvivalData(
  selectedExposureIds,
  selectedOutcomeIds,
  cdm,
  conceptLabelLookup,
  matchRatio = 4,
  washoutYears = 2,
  session = NULL
)
}
\arguments{
\item{selectedExposureIds}{A numeric vector of concept IDs for exposure conditions.}

\item{selectedOutcomeIds}{A numeric vector of concept IDs for outcome conditions.}

\item{cdm}{A CDM reference object created by \code{CDMConnector::cdmFromCon}.}

\item{conceptLabelLookup}{A tibble or data frame used as a lookup table to
find human-readable labels based on concept IDs. Must contain columns
\code{concept_id} and \code{concept_name_id} (where \code{concept_name_id} holds the label).
Used for labeling results.}

\item{matchRatio}{The target number of controls to match to each exposed person.}

\item{washoutYears}{The washout period in years. This is used to:
\enumerate{
\item Define a required period of observation before an outcome event for initial cohort eligibility (\code{filterByWashoutAndGetOutcomeDates}).
\item Define a required period of observation before an exposure event for an individual to be included in the exposed cohort (\code{defineExposedCohortForPair}).
\item Define a required period of observation for a control \emph{prior to the matched exposed's index date} (\code{performPairMatching}).
}}

\item{session}{Optional. The Shiny session object. If provided, notifications
will be shown in the Shiny UI. Otherwise, messages are printed to the console.}
}
\value{
A list where names are unique keys for each processed exposure-outcome
pair (e.g., "pair_exposureID_outcomeID"). Each element of the list is itself
a list containing:
\describe{
\item{survivalData}{The tibble generated by \code{calculatePairSurvival} for the pair.}
\item{exposureId}{Numeric ID of the exposure.}
\item{outcomeId}{Numeric ID of the outcome.}
\item{exposureLabel}{Character label for the exposure (from \code{conceptLabelLookup}).}
\item{outcomeLabel}{Character label for the outcome (from \code{conceptLabelLookup}).}
\item{nExposedIdentifiedInitial}{Count of exposed individuals after initial definition (meeting exposure washout and outcome post-exposure criteria).}
\item{nExposedMatched}{Count of exposed individuals successfully matched to >=1 control.}
\item{nUnexposedMatched}{Total count of matched unexposed controls.}
\item{nTotalPersonsInAnalysis}{Total number of rows (persons) in the final \code{survivalData} for the pair.}
}
Returns \code{NULL} if a major initial error occurs (e.g., fetching data fails,
initial cohort is empty) or if no exposure-outcome pairs yield valid results.
}
\description{
Orchestrates the process of fetching data, combining demographics/observation periods,
applying washout, defining cohorts, performing matching, calculating survival,
and returning results for multiple exposure-outcome pairs using Incidence
Density Matching principles. It calls specific helper functions for each step.
}
\keyword{internal}
